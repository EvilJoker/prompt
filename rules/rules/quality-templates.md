# 🔍 嵌入式质量检查模板库

## 🏷️ 规则元数据
- **类型**: 质量保证规范
- **编号**: quality-templates
- **版本**: v1.2
- **描述**: 嵌入式质量检查模板库，专注单元测试与代码质量
- **执行模式**: 嵌入式质量门禁，自动化检查
- **应用场景**: 设计阶段Step1、Step3、Step5，开发阶段Step2、Step4、Step5

---

## 🎯 质量检查目标

### 核心理念
**预防胜于修复** - 在关键节点嵌入质量检查，及早发现和解决问题

### 质量保证原则
- **自动化优先**: 能自动检查的绝不手工检查
- **关键节点控制**: 在设计和开发的关键步骤设置质量门禁
- **单元测试重点**: 专注单元测试质量，确保代码功能正确性
- **实用主义**: 质量检查要实用有效，不追求完美

---

## 📋 设计阶段质量门禁

### design_requirements_quality_gate
**应用时机**: 设计阶段Step1完成后
**检查目标**: 确保需求理解准确完整

```markdown
### 🔍 需求分析质量检查

#### 必检项目 (100%)
- ✅ **需求完整性**: 功能需求、非功能需求、约束条件全覆盖
- ✅ **业务价值清晰**: 明确解决什么问题，带来什么价值
- ✅ **可行性评估**: 技术可行性、时间可行性、资源可行性
- ✅ **风险识别**: 主要技术风险、业务风险、时间风险

#### 质量标准
- 需求理解完整性 ≥ 95%
- 业务价值表述清晰度 ≥ 90%
- 技术可行性评估准确性 ≥ 90%
- 风险识别覆盖率 ≥ 85%

#### 检查结果
- [ ] 通过: 可以进入Step2
- [ ] 不通过: 需要重新分析需求
```

### design_system_quality_gate
**应用时机**: 设计阶段Step3完成后
**检查目标**: 确保系统设计合理可行

```markdown
### 🔍 系统设计质量检查

#### 必检项目 (100%)
- ✅ **架构一致性**: 与技术栈和架构原则保持一致
- ✅ **接口设计规范**: RESTful风格、参数合理、返回值完整
- ✅ **数据模型合理**: 字段设计、关系设计、约束设计
- ✅ **可扩展性**: 支持未来功能扩展和性能扩展

#### 质量标准
- 架构一致性 ≥ 95%
- 接口设计规范性 ≥ 90%
- 数据模型合理性 ≥ 90%
- 设计文档完整性 ≥ 95%

#### 检查结果
- [ ] 通过: 可以进入Step4
- [ ] 不通过: 需要重新设计系统
```

### design_complete_quality_gate
**应用时机**: 设计阶段Step5完成后
**检查目标**: 确保设计文档完整可执行

```markdown
### 🔍 设计完整性质量检查

#### 必检项目 (100%)
- ✅ **文档完整性**: 所有设计章节完整，无缺失内容
- ✅ **设计一致性**: 各部分设计互相匹配，无冲突
- ✅ **可实现性**: 设计方案技术上可以实现
- ✅ **可测试性**: 设计具备可测试的接口和验证点

#### 质量标准
- 文档完整性 ≥ 95%
- 设计一致性 ≥ 90%
- 可实现性评估 ≥ 90%
- 可测试性设计 ≥ 85%

#### 检查结果
- [ ] 通过: 设计阶段完成，可进入开发
- [ ] 不通过: 需要完善设计文档
```

---

## 💻 开发阶段质量门禁

### interface_definition_quality_gate
**应用时机**: 开发阶段Step2完成后
**检查目标**: 确保接口定义完整规范

```markdown
### 🔍 接口定义质量检查

#### 必检项目 (100%)
- ✅ **接口完整性**: 所有设计接口100%定义，无遗漏
- ✅ **类型安全性**: 强类型定义覆盖率≥95%
- ✅ **注释规范性**: 每个公共接口都有功能说明、参数说明、返回值说明
- ✅ **设计一致性**: 与详设文档接口匹配度100%

#### 自动检查脚本
```bash
# 检查接口定义完整性
grep -r "TODO" src/ | grep -E "\.(js|ts|vue)$" | wc -l
# 检查类型注解覆盖率
grep -r "@param\|@returns" src/ | wc -l
# 检查函数注释覆盖率
grep -r "function\|async.*(" src/ | wc -l
```

#### 质量标准
- 接口定义完整率 = 100%
- 类型安全覆盖率 ≥ 95%
- 注释覆盖率 ≥ 90%
- 设计匹配度 = 100%

#### 检查结果
- [ ] 通过: 可以进入Step3
- [ ] 不通过: 需要完善接口定义
```

### unit_test_quality_gate
**应用时机**: 开发阶段Step4完成后
**检查目标**: 确保单元测试质量达标

```markdown
### 🔍 单元测试质量检查

#### 必检项目 (100%)
- ✅ **测试覆盖度**: 核心业务逻辑覆盖≥90%
- ✅ **边界测试完整**: 正常、异常、边界用例齐全
- ✅ **测试独立性**: 测试用例间无依赖关系
- ✅ **断言有效性**: 每个测试有明确的验证断言

#### 自动检查脚本
```bash
# 运行单元测试并生成覆盖率报告
npm run test:unit -- --coverage --reporter=json > coverage.json
# 检查测试文件数量
find tests/unit -name "*.test.js" | wc -l
# 检查断言数量
grep -r "expect\|assert" tests/unit/ | wc -l
```

#### 质量标准
- 核心业务逻辑覆盖 ≥ 90%
- 边界条件覆盖 ≥ 85%
- 异常处理覆盖 ≥ 90%
- 测试独立性 = 100%

#### 检查结果
- [ ] 通过: 可以进入Step5
- [ ] 不通过: 需要完善单元测试
```

### code_implementation_quality_gate
**应用时机**: 开发阶段Step5完成后
**检查目标**: 确保代码实现质量达标

```markdown
### 🔍 代码实现质量检查

#### 必检项目 (100%)
- ✅ **代码规范性**: ESLint/Prettier检查通过率100%
- ✅ **函数复杂度**: 单函数复杂度≤10
- ✅ **错误处理完整**: 异常场景处理覆盖≥95%
- ✅ **接口实现一致**: 与Step2接口定义匹配度100%

#### 自动检查脚本
```bash
# 代码规范检查
npm run lint
# 复杂度检查
npx complexity-report src/ --format json
# 错误处理检查
grep -r "try\|catch\|throw\|Error" src/ | wc -l
# TODO项检查
grep -r "TODO\|FIXME" src/ | wc -l
```

#### 质量标准
- 代码规范通过率 = 100%
- 函数复杂度 ≤ 10
- 错误处理覆盖 ≥ 95%
- 接口匹配度 = 100%

#### 检查结果
- [ ] 通过: 可以进入Step6
- [ ] 不通过: 需要优化代码实现
```

---

## 📊 质量检查执行模式

### 自动执行模式
```markdown
## 质量门禁自动执行

### 设计阶段
- Step1完成 → 自动执行 `design_requirements_quality_gate`
- Step3完成 → 自动执行 `design_system_quality_gate`
- Step5完成 → 自动执行 `design_complete_quality_gate`

### 开发阶段
- Step2完成 → 自动执行 `interface_definition_quality_gate`
- Step4完成 → 自动执行 `unit_test_quality_gate`
- Step5完成 → 自动执行 `code_implementation_quality_gate`

### 执行控制
- ✅ 质量门禁通过 → 继续下一步
- ❌ 质量门禁失败 → 重新处理当前步骤
- ⏸️ 等待用户确认 → 所有质量检查完成后
```

---

## 📈 质量报告模板

### 综合质量报告
```markdown
## 🎯 项目质量报告

### 📊 质量得分概览
- **设计质量**: [XX]/100
- **开发质量**: [XX]/100
- **整体质量**: [XX]/100

### 🔍 各阶段质量明细

#### 设计阶段质量
| 质量门禁 | 状态 | 得分 | 主要问题 |
|----------|------|------|----------|
| 需求分析质量检查 | ✅/❌ | XX/100 | [问题描述] |
| 系统设计质量检查 | ✅/❌ | XX/100 | [问题描述] |
| 设计完整性检查 | ✅/❌ | XX/100 | [问题描述] |

#### 开发阶段质量
| 质量门禁 | 状态 | 得分 | 主要问题 |
|----------|------|------|----------|
| 接口定义质量检查 | ✅/❌ | XX/100 | [问题描述] |
| 单元测试质量检查 | ✅/❌ | XX/100 | [问题描述] |
| 代码实现质量检查 | ✅/❌ | XX/100 | [问题描述] |

### 🚨 关键问题汇总
1. **重大问题**: [数量] 个 - [问题描述]
2. **一般问题**: [数量] 个 - [问题描述]
3. **建议改进**: [数量] 个 - [改进建议]

### 📋 质量改进建议
- **短期改进**: [具体建议]
- **长期优化**: [具体建议]
- **流程优化**: [具体建议]
```

---

## ⚡ 简化质量标准

### 设计阶段质量要求
```markdown
#### 强制要求 (必须100%)
- ✅ 需求理解完整性
- ✅ 设计文档完整性
- ✅ 架构一致性

#### 建议指标 (目标≥90%)
- 📊 业务价值清晰度 ≥ 90%
- 📊 可行性评估准确性 ≥ 90%
- 📊 接口设计规范性 ≥ 90%
```

### 开发阶段质量要求
```markdown
#### 强制要求 (必须100%)
- ✅ 接口定义完整性
- ✅ 单元测试通过率
- ✅ 代码规范通过率

#### 建议指标 (目标≥90%)
- 📊 单元测试覆盖率 ≥ 90%
- 📊 错误处理覆盖率 ≥ 95%
- 📊 接口实现匹配度 ≥ 100%
```

---

## 💡 质量优化建议

### 持续改进机制
- **定期评估**: 每个项目结束后评估质量标准有效性
- **标准优化**: 根据实际情况调整质量门禁标准
- **自动化提升**: 逐步增加自动化检查项目

### 工具支持建议
- **代码质量**: ESLint, Prettier, SonarQube
- **单元测试**: Vitest, Jest, 覆盖率工具
- **文档检查**: 文档完整性检查脚本
- **自动化流程**: Git hooks, CI/CD pipeline

---

## 总结

嵌入式质量检查模板库提供**6个关键质量门禁**：

**设计阶段**: 需求分析 → 系统设计 → 设计完整性
**开发阶段**: 接口定义 → 单元测试 → 代码实现

**核心价值**:
- **预防为主**: 关键节点设置质量门禁
- **自动化**: 减少人工检查工作量
- **实用性**: 专注最重要的质量指标
- **嵌入式**: 无缝集成到开发流程中 